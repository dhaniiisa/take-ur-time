<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Mood & Notes</title>

<style>
*{box-sizing:border-box;}
body{
    margin:0;
    font-family:"Poppins",sans-serif;
    background:linear-gradient(135deg,#e6ffca,#f7ffe1);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}
.app{
    background:#fff;
    width:100%;
    max-width:380px;
    padding:16px;
    border-radius:22px;
    box-shadow:0 15px 30px rgba(0,0,0,.2);
}

/* ===== INTRO ===== */
.intro{
    text-align:center;
    margin-bottom:14px;
}
.intro h1{
    font-size:18px;
    margin:0;
    font-weight:600;
}
.intro p{
    font-size:12px;
    margin-top:6px;
    color:#666;
}

/* ===== HEADER ===== */
.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:10px;
}
.header button{
    background:#a6c1ee;
    border:none;
    color:#fff;
    font-size:18px;
    padding:6px 12px;
    border-radius:10px;
    cursor:pointer;
}
.header h2{font-size:16px;}

/* ===== CALENDAR ===== */
.days,.dates{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    text-align:center;
}
.days div{
    font-size:11px;
    font-weight:600;
    color:#666;
}

/* TANGGAL */
.date{
    margin:4px;
    padding:6px 4px;
    border-radius:14px;
    background:#f1f1f1;
    cursor:pointer;
    position:relative;
    transition:.2s;

    height:64px;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    overflow:hidden;
}
.date:hover{transform:scale(1.05);}
.date > div:first-child{
    font-size:12px;
    font-weight:600;
}

/* WARNA MOOD */
.mood-happy{background:#b5ead7;}
.mood-normal{background:#fff1ac;}
.mood-sad{background:#81c8ef;}
.mood-angry{background:#ff9aa2;}
.mood-excited{background:#cdb4db;}

/* PREVIEW NOTE */
.note-preview{
    font-size:9px;
    opacity:.6;
    margin-top:2px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    width:100%;
}

/* EMOJI */
.mood-emoji{
    position:absolute;
    bottom:4px;
    right:6px;
    font-size:12px;
}

/* ===== NEXT PAGE ===== */
.next-page{
    margin-top:14px;
}
.next-page button{
    width:100%;
    padding:12px;
    border:none;
    border-radius:16px;
    background:linear-gradient(135deg,#ff5372,#ffa2b6);
    color:#fff;
    font-size:14px;
    font-weight:600;
    cursor:pointer;
    transition:.2s;
}
.next-page button:hover{
    transform:translateY(-2px);
    box-shadow:0 6px 12px rgba(0,0,0,.15);
}

/* ===== MODAL ===== */
.modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.4);
    justify-content:center;
    align-items:center;
}
.modal-content{
    background:#fff;
    width:90%;
    max-width:320px;
    padding:16px;
    border-radius:18px;
}
.moods{
    display:flex;
    justify-content:space-between;
    font-size:26px;
    margin-bottom:8px;
}
.moods span{
    cursor:pointer;
    opacity:.4;
}
.moods span.active{
    opacity:1;
    transform:scale(1.2);
}
textarea{
    width:100%;
    height:90px;
    border-radius:12px;
    border:1px solid #ccc;
    padding:10px;
    resize:none;
}
.save-btn,.delete-btn{
    width:100%;
    margin-top:8px;
    padding:10px;
    border:none;
    border-radius:12px;
    color:#fff;
}
.save-btn{background:#4488ff;}
.delete-btn{background:hsl(355, 100%, 71%);font-size:13px;}
</style>
</head>

<body>

<div class="app">

    <div class="intro">
        <h1>Daily Mood & Notes</h1>
        <p>Click on the date to write a note üå±</p>
    </div>

    <div class="header">
        <button onclick="changeMonth(-1)">‚Äπ</button>
        <h2 id="monthYear"></h2>
        <button onclick="changeMonth(1)">‚Ä∫</button>
    </div>

    <div class="days">
        <div>Min</div><div>Sen</div><div>Sel</div>
        <div>Rab</div><div>Kam</div><div>Jum</div><div>Sab</div>
    </div>

    <div class="dates" id="dates"></div>

    <!-- NEXT PAGE -->
    <div class="next-page">
        <button onclick="goNext()">next fun</button>
    </div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
    <div class="modal-content">
        <div class="moods">
            <span onclick="pickMood('üòä','happy')">üòä</span>
            <span onclick="pickMood('üòê','normal')">üòê</span>
            <span onclick="pickMood('üò¢','sad')">üò¢</span>
            <span onclick="pickMood('üò°','angry')">üò°</span>
            <span onclick="pickMood('ü§©','excited')">ü§©</span>
        </div>
        <textarea id="note" placeholder="Tulis catatan..."></textarea>
        <button class="save-btn" onclick="saveData()">Simpan</button>
        <button class="delete-btn" onclick="deleteData()">Hapus</button>
    </div>
</div>

<script>
let current=new Date();
let selectedKey="";
let selectedMood={emoji:"",class:""};

function renderCalendar(){
    const dates=document.getElementById("dates");
    dates.innerHTML="";
    const y=current.getFullYear();
    const m=current.getMonth();

    document.getElementById("monthYear").innerText=
        current.toLocaleDateString("id-ID",{month:"long",year:"numeric"});

    const firstDay=new Date(y,m,1).getDay();
    const total=new Date(y,m+1,0).getDate();
    const data=JSON.parse(localStorage.getItem("moodNotes"))||{};

    for(let i=0;i<firstDay;i++) dates.innerHTML+="<div></div>";

    for(let d=1;d<=total;d++){
        const key=`${y}-${m}-${d}`;
        const div=document.createElement("div");
        div.className="date";

        const day=document.createElement("div");
        day.innerText=d;
        div.appendChild(day);

        if(data[key]){
            if(data[key].moodClass){
                div.classList.add("mood-"+data[key].moodClass);
            }
            if(data[key].note){
                const preview=document.createElement("div");
                preview.className="note-preview";
                preview.innerText=data[key].note;
                div.appendChild(preview);
            }
            if(data[key].mood){
                const emoji=document.createElement("div");
                emoji.className="mood-emoji";
                emoji.innerText=data[key].mood;
                div.appendChild(emoji);
            }
        }

        div.onclick=()=>openModal(key);
        dates.appendChild(div);
    }
}

function changeMonth(step){
    current.setMonth(current.getMonth()+step);
    renderCalendar();
}

function openModal(key){
    selectedKey=key;
    selectedMood={emoji:"",class:""};
    document.querySelectorAll(".moods span").forEach(s=>s.classList.remove("active"));

    const data=JSON.parse(localStorage.getItem("moodNotes"))||{};
    document.getElementById("note").value=data[key]?.note||"";

    if(data[key]?.mood){
        selectedMood.emoji=data[key].mood;
        selectedMood.class=data[key].moodClass;
        document.querySelectorAll(".moods span").forEach(s=>{
            if(s.innerText===selectedMood.emoji) s.classList.add("active");
        });
    }
    document.getElementById("modal").style.display="flex";
}

function pickMood(emoji,cls){
    selectedMood={emoji,class:cls};
    document.querySelectorAll(".moods span").forEach(s=>{
        s.classList.toggle("active",s.innerText===emoji);
    });
}

function saveData(){
    const note=document.getElementById("note").value.trim();
    if(!note && !selectedMood.emoji){
        document.getElementById("modal").style.display="none";
        return;
    }
    const data=JSON.parse(localStorage.getItem("moodNotes"))||{};
    data[selectedKey]={
        note,
        mood:selectedMood.emoji,
        moodClass:selectedMood.class
    };
    localStorage.setItem("moodNotes",JSON.stringify(data));
    document.getElementById("modal").style.display="none";
    renderCalendar();
}

function deleteData(){
    const data=JSON.parse(localStorage.getItem("moodNotes"))||{};
    delete data[selectedKey];
    localStorage.setItem("moodNotes",JSON.stringify(data));
    document.getElementById("modal").style.display="none";
    renderCalendar();
}

function goNext(){
    alert("Next page bisa kamu arahkan ke halaman lain üöÄ");
    // window.location.href = "catchM.html";
}

renderCalendar();

function goNext() {
    window.location.href = "catchM.html";
}

loadMood();
</script>

</body>
</html>
