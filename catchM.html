<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Catch The Feeling</title>

<style>
body{
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:Poppins, sans-serif;
    background:#f6d365;
    transition:background.5s;
}

.game-box{
    width:360px;
    height:540px;
    background:white;
    border-radius:20px;
    box-shadow:0 20px 40px rgba(0,0,0,.25);
    text-align:center;
    position:relative;
    overflow:hidden;
}

h2{ margin:15px 0 5px; }

.moods button{
    margin:4px;
    border:none;
    padding:8px 12px;
    border-radius:20px;
    cursor:pointer;
    font-size:18px;
}

.score{
    font-weight:bold;
    margin:10px;
}

.emoji{
    position:absolute;
    font-size:32px;
    cursor:pointer;
    top:-40px;
    animation:fall 1.7s linear forwards;
}

@keyframes fall{
    to{ top:540px; }
}

.win{
    position:absolute;
    inset:0;
    background:rgba(255,255,255,.96);
    display:none;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    gap:12px;
    font-size:22px;
}

.win button{
    padding:8px 16px;
    border:none;
    border-radius:18px;
    cursor:pointer;
    background:#222;
    color:white;
}
</style>
</head>
<body>

<div class="game-box">
    <h2>Catch The Feeling</h2>
    <p>Choose your mood</p>

    <div class="moods">
        <button onclick="startGame('happy','ğŸ˜„')">ğŸ˜„</button>
        <button onclick="startGame('sad','ğŸ˜¢')">ğŸ˜¢</button>
        <button onclick="startGame('angry','ğŸ˜¡')">ğŸ˜¡</button>
        <button onclick="startGame('calm','ğŸ˜Œ')">ğŸ˜Œ</button>
    </div>

    <div class="score">Score: <span id="score">0</span></div>

    <div class="win" id="win">
        ğŸ‰ YOU WIN ğŸ‰
        <small>Score 100</small>
        <button onclick="nextPage()">â–¶ Next Page</button>
        <button onclick="playAgain()">ğŸ” Play Again</button>
    </div>
</div>

<!-- SOUND -->
<audio id="good" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
<audio id="bad" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>

<script>
let targetEmoji="";
let score=0;
let interval=null;
let active=0;
let randomCount=0;
let nextTargetAt=0;

const MAX_EMOJI=4;
const emojis=["ğŸ˜„","ğŸ˜¢","ğŸ˜¡","ğŸ˜Œ","ğŸ¥º","ğŸ˜­","ğŸ˜Š","ğŸ˜"];
const scoreEl=document.getElementById("score");
const box=document.querySelector(".game-box");
const winBox=document.getElementById("win");

const bg={
    happy:"linear-gradient(135deg,#f6d365,#fda085)",
    sad:"linear-gradient(135deg,#a1c4fd,#c2e9fb)",
    angry:"linear-gradient(135deg,#ff512f,#dd2476)",
    calm:"linear-gradient(135deg,#d4fc79,#96e6a1)"
};

function startGame(mood,emoji){
    resetGame();
    targetEmoji=emoji;
    document.body.style.background=bg[mood];
    nextTargetAt = randomRange(3,5); // ğŸ”¥ 3â€“5 random dulu
    interval=setInterval(dropEmoji,800);
}

function dropEmoji(){
    if(active>=MAX_EMOJI) return;

    const e=document.createElement("div");
    e.className="emoji";

    let chosenEmoji;

    if(randomCount >= nextTargetAt){
        chosenEmoji = targetEmoji;      // ğŸ¯ PASTI MOOD
        randomCount = 0;
        nextTargetAt = randomRange(3,5);
    }else{
        chosenEmoji = emojis[Math.floor(Math.random()*emojis.length)];
        randomCount++;
    }

    e.textContent = chosenEmoji;
    e.style.left = Math.random()*280 + 30 + "px";
    active++;

    e.onclick=()=>{
        if(chosenEmoji===targetEmoji){
            score+=10;
            good.currentTime=0; good.play();
        }else{
            score-=5;
            bad.currentTime=0; bad.play();
        }
        scoreEl.textContent=score;
        removeEmoji(e);
        if(score>=100) winGame();
    };

    box.appendChild(e);
    setTimeout(()=>removeEmoji(e),2000);
}

function removeEmoji(e){
    if(e.parentNode){
        e.remove();
        active--;
    }
}

function winGame(){
    clearInterval(interval);
    winBox.style.display="flex";
}

function playAgain(){
    resetGame();
}

function nextPage(){
    window.location.href="last.html"; // ganti sesuai file kamu
}

function resetGame(){
    clearInterval(interval);
    interval=null;
    score=0;
    active=0;
    randomCount=0;
    scoreEl.textContent=0;
    winBox.style.display="none";
    document.querySelectorAll(".emoji").forEach(e=>e.remove());
}

function randomRange(min,max){
    return Math.floor(Math.random()*(max-min+1))+min;
}
</script>

</body>
</html>
